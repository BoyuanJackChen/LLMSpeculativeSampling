
import torch
import argparse
import contexttimer
from colorama import Fore, Style
from transformers import AutoTokenizer, AutoModelForCausalLM
import time

from sampling import autoregressive_sampling, speculative_sampling, speculative_sampling_batch, speculative_sampling_v2
from globals import Decoder
from human_eval.data import read_problems



tokenizer = AutoTokenizer.from_pretrained("WizardLM/WizardCoder-Python-7B-V1.0", trust_remote_code=True, padding_side='left')
A = [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000,
         32000, 32000, 32000, 32000, 32000, 32000, 32000,     2, 13866,   338,
           385, 15278,   393, 16612,   263,  3414, 29889, 14350,   263,  2933,
           393,  7128,  2486,  1614,  2167,   278,  2009, 29889,    13,    13,
            13,  2277, 29937,  2799,  4080, 29901,    13,  4391,   263,  5132,
          2471,   363,   445,  1108, 29901,    13,    13,    13,  1753, 14176,
         29918,  9435, 29918,  4563,   275,   272, 29898, 29874, 29901,   938,
         29892,   289, 29901,   938, 29897,  1599,   938, 29901,    13,  1678,
          9995,  7106,   263, 14176,  3619,  8572,   272,   310,  1023, 11920,
           263,   322,   289,    13,  1678,  8653, 14176, 29918,  9435, 29918,
          4563,   275,   272, 29898, 29941, 29892, 29871, 29945, 29897,    13,
           268, 29896,    13,  1678,  8653, 14176, 29918,  9435, 29918,  4563,
           275,   272, 29898, 29906, 29945, 29892, 29871, 29896, 29945, 29897,
            13,   268, 29945,    13,  1678,  9995,    13,    13,    13,  2277,
         29937, 13291, 29901]
B = [    2, 13866,   338,   385, 15278,   393, 16612,   263,  3414, 29889,
         14350,   263,  2933,   393,  7128,  2486,  1614,  2167,   278,  2009,
         29889,    13,    13,    13,  2277, 29937,  2799,  4080, 29901,    13,
          4391,   263,  5132,  2471,   363,   445,  1108, 29901,    13,    13,
            13,  1753,   920, 29918, 13011, 29918,  3706, 29898,  1807, 29901,
           851, 29892, 28228, 29901,   851, 29897,  1599,   938, 29901,    13,
          1678,  9995, 10987,   920,  1784,  3064,   263,  2183, 28228,   508,
           367,  1476,   297,   278,  2441,  1347, 29889,  3917, 25457,   292,
          4251, 29889,    13,  1678,  8653,   920, 29918, 13011, 29918,  3706,
           877,   742,   525, 29874,  1495,    13,   268, 29900,    13,  1678,
          8653,   920, 29918, 13011, 29918,  3706,   877,  7340, 29874,   742,
           525, 29874,  1495,    13,   268, 29941,    13,  1678,  8653,   920,
         29918, 13011, 29918,  3706,   877, 27137,   742,   525,  7340,  1495,
            13,   268, 29941,    13,  1678,  9995,    13,    13,    13,  2277,
         29937, 13291, 29901]
C = [    2, 13866,   338,   385, 15278,   393, 16612,   263,  3414, 29889,
         14350,   263,  2933,   393,  7128,  2486,  1614,  2167,   278,  2009,
         29889,    13,    13,    13,  2277, 29937,  2799,  4080, 29901,    13,
          4391,   263,  5132,  2471,   363,   445,  1108, 29901,    13,    13,
            13,  1753,   920, 29918, 13011, 29918,  3706, 29898,  1807, 29901,
           851, 29892, 28228, 29901,   851, 29897,  1599,   938, 29901,    13,
          1678,  9995, 10987,   920,  1784,  3064,   263,  2183, 28228,   508,
           367,  1476,   297,   278,  2441,  1347, 29889,  3917, 25457,   292,
          4251, 29889,    13,  1678,  8653,   920, 29918, 13011, 29918,  3706,
           877,   742,   525, 29874,  1495,    13,   268, 29900,    13,  1678,
          8653,   920, 29918, 13011, 29918,  3706,   877,  7340, 29874,   742,
           525, 29874,  1495,    13,   268, 29941,    13,  1678,  8653,   920,
         29918, 13011, 29918,  3706,   877, 27137,   742,   525,  7340,  1495,
            13,   268, 29941,    13,  1678,  9995,    13,    13,    13,  2277,
         29937, 13291, 29901, 10605, 29915, 29879,   278,  5132,  2471,   363,
           278,  1108, 29901, 30004,    13, 30004,    13, 28956,  4691, 30004,
            13,  1753,   920, 29918, 13011, 29918,  3706, 29898,  1807, 29901,
           851, 29892, 28228, 29901,   851, 29897,  1599,   938, 29901, 30004,
            13,  1678,  9995, 10987,   920,  1784,  3064,   263,  2183, 28228,
           508,   367,  1476,   297,   278,  2441,  1347, 29889,  3917, 25457,
           292,  4251, 22993,    13,  1678,  8653,   920, 29918, 13011, 29918,
          3706,   877,   742,   525, 29874,  1495, 30004,    13,   268, 29900,
         30004,    13,  1678,  8653,   920, 29918, 13011, 29918,  3706,   877,
          7340, 29874,   742,   525, 29874,  1495, 30004,    13,   268, 29941,
         30004,    13,  1678,  8653,   920, 29918, 13011, 29918,  3706,   877,
         27137,   742,   525,  7340,  1495, 30004,    13]
print(tokenizer.decode(A))
print(tokenizer.decode(B))
print(tokenizer.decode(C))